<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>WebSocket Audio Player</title>
  </head>
  <body>
    <h1>WebSocket Audio Player</h1>
    <button onclick="startAudio()">Play Audio</button>
    <audio
      id="audioPlayer"
      src="https://cdn.thefyrewire.com/uploads/addc9924-51a2-4874-a079-5f473e18f5b9.mp3"
    ></audio>

    <script>
      var websocket;

      function initializeWebSocket() {
        const protocol = location.protocol === "https:" ? "wss:" : "ws:";
        websocket = new WebSocket(
          protocol +
            "//" +
            location.hostname +
            ":" +
            (protocol === "wss:" ? "443" : "9001")
        );

        websocket.onopen = function () {
          console.log("WebSocket connection opened");
        };

        websocket.onmessage = function (event) {
          var message = JSON.parse(event.data);
          if (message.action === "play_audio") {
            var audio = document.getElementById("audioPlayer");
            audio
              .play()
              .then(() => {
                console.log("Audio playback started successfully");
              })
              .catch((error) => {
                console.log("Error starting audio playback:", error);
              });
          }
        };

        websocket.onerror = function (error) {
          console.error("WebSocket error:", error);
        };

        websocket.onclose = function () {
          console.log("WebSocket connection closed");
        };
      }

      function startAudio() {
        var audio = document.getElementById("audioPlayer");
        audio
          .play()
          .then(() => {
            console.log("Audio playback started successfully");
            websocket.send(JSON.stringify({ action: "play_audio" }));
          })
          .catch((error) => {
            console.error("Error starting audio playback:", error);
          });
      }

      window.onload = function () {
        initializeWebSocket();
      };
    </script>
  </body>
</html>
